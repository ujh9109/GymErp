<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ModalMapper">

 <!-- ===================================================== -->
 <!-- 서비스 상품 선택 모달 -->
 <!-- ===================================================== -->

 <!-- 서비스 선택 모달 목록 조회 -->
  <select id="selectServiceList" resultType="SalesService">
    SELECT
      s.serviceId AS serviceId,
      s.name AS serviceName,
      s.price AS avgPrice,
      s.serviceType,
      s.status
    FROM SERVICE s
    WHERE s.status != 'DELETED'
    <if test="keyword != null and keyword != ''">
      AND s.name LIKE '%' || #{keyword} || '%'
    </if>
    ORDER BY 
      CASE WHEN s.serviceType = 'PT' THEN 0 ELSE 1 END,
      s.name DESC
    OFFSET #{offset} ROWS FETCH NEXT #{limit} ROWS ONLY
  </select>

  <!-- 서비스 총 개수 조회 -->
  <select id="countServiceList" resultType="int">
    SELECT COUNT(*)
    FROM SERVICE s
    WHERE s.status != 'DELETED'
    <if test="keyword != null and keyword != ''">
      AND s.name LIKE '%' || #{keyword} || '%'
    </if>
  </select>
</mapper>